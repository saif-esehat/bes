<odoo>
    <template id="custom_portal_my_details" inherit_id="portal.portal_my_details">
        <xpath expr="//div[@class='clearfix'][1]/following-sibling::*[1]" position="replace">
            <t t-if="env.user.has_group('bes.group_gp_candidates')">
                <t t-set="institute" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).institute_id.name"/>

                <div class="form-group  col-xl-6">
                    <label class="col-form-label" for="email">Institute</label>
                    <input type="email" name="email" t-attf-value="{{institute}}" t-att-readonly="1" class="form-control "/>
                </div>
            </t>
            <t t-else="">
                <div t-attf-class="form-group mb-1 #{error.get('company_name') and 'o_has_error' or ''} col-xl-6">
                    <label class="col-form-label label-optional" for="company_name">Company Name</label>
                    <!-- The <input> use "disabled" attribute to avoid sending an unauthorized value on form submit.
                                        The user might not have rights to change company_name but should still be able to see it.
                                    -->
                    <input type="text" name="company_name" t-attf-class="form-control #{error.get('company_name') and 'is-invalid' or ''}" t-att-value="company_name or partner.commercial_company_name" t-att-disabled="None if partner_can_edit_vat else '1'" />
                    <small t-if="not partner_can_edit_vat" class="form-text text-muted d-block d-xl-none">
                                        Changing company name is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.
                    </small>
                </div>
            </t>
        </xpath>
        <xpath expr="//label[@for='vat']/parent::div" position="replace">
            <t t-if="env.user.has_group('bes.group_gp_candidates')">
                <t t-set="mobile" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).mobile"/>

                <div class="form-group  col-xl-6">
                    <label class="col-form-label" for="email">Mobile</label>
                    <input type="email" name="email" t-attf-value="{{mobile}}" t-att-readonly="1" class="form-control "/>
                </div>
            </t>
            <t t-else="">
                <div t-attf-class="form-group mb-1 #{error.get('vat') and 'o_has_error' or ''} col-xl-6">
                    <label class="col-form-label label-optional" for="vat">PAN Number</label>

                    <input type="text" name="vat" t-attf-class="form-control #{error.get('vat') and 'is-invalid' or ''}" t-att-value="vat or partner.vat" t-att-disabled="None if partner_can_edit_vat else '1'" />
                    <small t-if="not partner_can_edit_vat" class="form-text text-muted d-block d-xl-none">Changing PAN number is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.</small>
                </div>
            </t>
        </xpath>
        <xpath expr="//label[@for='country_id']/parent::div" position="replace">
            <t t-if="env.user.has_group('bes.group_gp_candidates')">
                <t t-set="country" t-value="env['res.country'].sudo().search([('code','=','IN')])"/>

                <div class="form-group  col-xl-6">
                    <label class="col-form-label label-optional" for="country_id">Country:</label>
                    <select name="country_id" t-attf-class="form-control" t-att-disabled="1">
                    <option t-attf-value="{{country.id}}" t-att-selected="1" class="form-control">
                        <t t-out="country.name" />
                    </option>
                    </select>
                </div>
            </t>
            <t t-else="">

                <div t-attf-class="form-group #{error.get('country_id') and 'o_has_error' or ''} col-xl-6">
                    <label class="col-form-label" for="country_id">Country</label>
                    <select name="country_id" t-attf-class="form-control #{error.get('country_id') and 'is-invalid' or ''}">
                        <option value="">Country...</option>
                        <t t-foreach="countries or []" t-as="country">
                            <option t-att-value="country.id" t-att-selected="country.id == int(country_id) if country_id else country.id == partner.country_id.id">
                                <t t-esc="country.name" />
                            </option>
                        </t>
                    </select>
                </div>

            </t>

        </xpath>
        <xpath expr="//label[@for='state_id']/parent::div" position="replace">

            <t t-if="env.user.has_group('bes.group_gp_candidates')">
                <t t-set="state" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).state_id"/>
                <div class="form-group  col-xl-6">
                    <label class="col-form-label label-optional" for="states_id">State / Province:</label>
                    <select name="states_id" class="form-control"  t-att-disabled="1" >
                    <option t-attf-value="{{state.id}}" t-att-selected="1" class="form-control">
                        <t t-out="state.name" />
                    </option>
                    </select>
                </div>
            </t>
            <t t-else="">

                <div t-attf-class="form-group #{error.get('state_id') and 'o_has_error' or ''} col-xl-6">
                    <label class="col-form-label label-optional" for="state_id">State / Province</label>
                    <select name="state_id" t-attf-class="form-control #{error.get('state_id') and 'is-invalid' or ''}">
                        <option value="">select...</option>
                        <t t-foreach="states or []" t-as="state">
                            <option t-att-value="state.id" style="display:none;" t-att-data-country_id="state.country_id.id" t-att-selected="state.id == partner.state_id.id">
                                <t t-esc="state.name" />
                            </option>
                        </t>
                    </select>
                </div>
            </t>

        </xpath>
         <xpath expr="//label[@for='states_id']/parent::div" position="after">
                <t t-set="indos_no" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).indos_no"/>
                <t t-if="env.user.has_group('bes.group_gp_candidates')">
                    <div class="form-group  col-xl-6">
                        <label class="col-form-label" for="email">Indos No.</label>
                        <input type="email" name="email" t-attf-value="{{indos_no}}" t-att-readonly="1" class="form-control "/>
                    </div>
                </t>
          </xpath>
          <xpath expr="//div[@class='col-lg-8']" position="after">
            <div class="col-lg-4">
                <t t-set="candidate_image" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).candidate_image"/>
                <t t-set="candidate_signature" t-value="env['gp.candidate'].sudo().search([('user_id','=',env.user.id)]).candidate_signature"/>

                 <div class="row">
                    <t t-if="candidate_image">
                        <img t-attf-src="data:image/png; base64, {{candidate_image}}" alt="avatar" class="img-fluid" style="width: 150px;margin-top: 40px; margin-left:25px;" />
                    </t>
                    <t t-else="">
                        <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" alt="avatar" class="img-fluid" style="width: 150px;margin-top: 40px; margin-left:25px;"/>
                    </t>  
                   
                </div>
                <div class="col">
                    
                     <t t-if="candidate_signature">
                        <span style="margin-top: 25px; margin-left:25px;"><h4>Signature</h4></span>
                        <img t-attf-src="data:image/png; base64, {{candidate_signature}}" alt="avatar" class="img-fluid" style="width: 150px;margin-top: 20px; margin-left:15px;" />
                    </t>
                    <!-- <t t-else="">
                        <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" alt="avatar" class="img-fluid" style="width: 150px;margin-top: 20px; margin-left:15px;"/>
                    </t>                  -->
                 </div>
            </div>
               
          </xpath>



    </template>
        
    <template id="exam_application_form_template" name="Exam Application Form">
        <t t-call="portal.portal_layout">
            <script>
                document.addEventListener('DOMContentLoaded', function(event) {

                const checkboxes = document.querySelectorAll('.form-check-input');
                var totalAmountElement = document.querySelector('.total_span');


                checkboxes.forEach(function(checkbox) {
                    checkbox.addEventListener('change', updateTotalAmount);
                });


                function updateTotalAmount() {

                    let total = 0;
                    var anyChecked = false; 

                    checkboxes.forEach(function(checkbox) {
                        if (checkbox.checked) {
                            anyChecked = true; 
                            var postData = {
                                product_code: checkbox.value 
                            };

                            <!-- total += parseFloat(checkbox.value); -->
                            $.ajax({
                                        type: "POST",
                                        url: '/my/getproductprice',
                                        data: JSON.stringify(postData),
                                        contentType: 'application/json',
                                        success: function (response) {

                                            console.log("POST request successful:", JSON.parse(response.result));
                                            var amount = JSON.parse(response.result).amount

                                            
                                            total += parseFloat(amount);
                                            totalAmountElement.textContent = 'Total Amount: ₹' + total;


                                            // if response["status"]
                                            // Handle success response
                                        },
                                            error: function (xhr, status, error) {
                                                console.error("POST request failed:", error);

                                                // Handle error
                                            }
                                        });
                        }

                        if (!anyChecked) {
                                total = 0;
                                totalAmountElement.textContent = 'Total Amount: ₹' + total;
                            }

                        
                    }
                    

                    
                    
                    
                    
                    
                    );

                    <!-- debugger -->


                }
            });

            document.addEventListener('DOMContentLoaded', function() {
                var mobileInput = document.getElementById('mobile');
                var emailInput = document.getElementById('email');
            
                // Check if candidate.mobile is empty
                if (mobileInput.value) {
                    mobileInput.disabled = true;
                }
            
                // Check if candidate.email is empty
                if (emailInput.value) {
                    emailInput.disabled = true;
                }
            });
            
            function toggleInstituteInput() {
                var instituteSelect = document.getElementById("institute_name");
                var otherInstituteContainer = document.getElementById("other_institute_name_container");
        
                if (instituteSelect.value == "114") { // The ID for "Others"
                    otherInstituteContainer.style.display = "block";
                } else {
                    otherInstituteContainer.style.display = "none";
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                // Initialize variables for input elements
                var mobileInput = document.getElementById('mobile');
                var emailInput = document.getElementById('email');
                var errorParagraph = document.getElementById('mobile-error');
                var checkboxes = document.querySelectorAll('.exam-checkbox');
                var selectedSubjectsElement = document.getElementById('selected-subjects');
            
                // Disable mobile and email inputs if they already have values
                if (mobileInput.value) {
                    mobileInput.disabled = true;
                }
                if (emailInput.value) {
                    emailInput.disabled = true;
                }
            
                // Get today's date in YYYY-MM-DD format
                const today = new Date().toISOString().split('T')[0];
                
                // Set the max attribute of date inputs to today's date
                document.getElementById('payment_date').setAttribute('max', today);
                document.getElementById('course_start_date').setAttribute('max', today);
                document.getElementById('course_end_date').setAttribute('max', today);
            
                // Function to update the list of selected subjects
                function updateSelectedSubjects() {
                    var selectedSubjects = [];
                    checkboxes.forEach(function(checkbox) {
                        if (checkbox.checked) {
                            selectedSubjects.push(checkbox.nextElementSibling.textContent.trim());
                        }
                    });

                    // Display the selected subjects or a message if none are selected
                    if (selectedSubjects.length &gt; 0) {
                        selectedSubjectsElement.innerHTML = 'You have selected these subjects: <strong class='text-danger'>' + selectedSubjects.join(', ') + '</strong>';
                    } else {
                        selectedSubjectsElement.textContent = 'You have not selected any subjects.';
                    }
                }

                // Attach change event listeners to checkboxes
                checkboxes.forEach(function(checkbox) {
                    checkbox.addEventListener('change', updateSelectedSubjects);
                });

                // Initialize the selected subjects message on page load
                updateSelectedSubjects();

            
                // Function to validate mobile number length
                function validateMobileLength(input) {
                    var value = input.value.replace(/\D/g, ''); // Remove non-digit characters
            
                    // Trim value to 10 digits if necessary
                    if (value.length &gt; 10) {
                        input.value = value.slice(0, 10);
                    }
            
                    // Display an error message if the input length is less than 10 digits
                    if (value.length &lt; 10 &amp;&amp; value.length &gt; 0) {
                        errorParagraph.textContent = "Mobile number must be exactly 10 digits.";
                        input.setCustomValidity("Mobile number must be exactly 10 digits.");
                    } else if (value.length === 10) {
                        errorParagraph.textContent = ""; // Clear error message
                        input.setCustomValidity(""); // Clear custom validity
                    } else {
                        errorParagraph.textContent = ""; // Clear error message if input is empty
                        input.setCustomValidity(""); // Clear custom validity
                    }
                }
            
                // Attach input event listener to mobile input for validation
                if (mobileInput) {
                    mobileInput.addEventListener('input', function() {
                        validateMobileLength(mobileInput);
                    });
                }
            });
            
            </script>
            <div class="container mt16">
                <span style="color: red; font-weight: bold;font-size: 22px;">Click <a href="https://bestrust.in//document/download/3/4bc677d6-b8ed-45a9-928f-2afda007c659/4" target="_blank">here</a> to read instructions to fill the form</span>

                <h2>Application Form GP Rating (Repeater) Examination</h2>
                <p class="mb-0" style="font-size:20px;"><strong>Application For: <t t-out="batch.batch_name"/></strong></p>
                <p class="mb-0" style="font-size:20px;"><strong class="text-danger">Last date of submission for <t t-out="batch.to_date.strftime('%B %Y')"/> Examination: <t t-out="batch.form_deadline.strftime('%d-%b-%y')"/></strong></p>
                <p>All Fields are mandatory</p>
                <form id="gp_repeater_submission_form" name="gp_repeater_submit" action="/my/application/view" enctype="multipart/form-data" method="post">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <input type="hidden" name="batch_id" id="batch_id" t-attf-value="{{batch.id}}" />
                    <input type="hidden" name="stcw_table_data" id="stcw_table_data"  />
                    <input type="hidden" name="certificate_criteria" id="certificate_criteria"  t-att-value="candidate.stcw_criteria"/>


                    <div class="form-group row">
                        <div class="col-lg-9">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Full Name:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.name"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Indos No:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.indos_no"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Code No:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.candidate_code"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong><label for="gender">Gender: <strong class="text-danger">*</strong></label></strong></p>
                                    </div>
                                    <div class="col-sm-3">
                                        <select class="form-control" id="gender" name="gender" required="1">
                                            <option value="male">Male</option>
                                            <option value="female">Female</option>
                                        </select>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Pre-Sea Training Institute:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.institute_id.name"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                            </div>
                        </div>
                        <div class="col-3 text-center">
                            <div class="row justify-content-center mb-2">
                                <div class="col-12">
                                    <t t-if="candidate.candidate_image">
                                        <img t-attf-src="data:image/png;base64, {{candidate.candidate_image}}" alt="avatar" class="rounded img-fluid" style="width: 150px;"/>
                                    </t>
                                    <t t-else="">
                                        <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" alt="avatar" class="rounded-circle img-fluid" style="width: 150px;"/>
                                    </t>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-12">
                                    <t t-if="candidate.candidate_signature">
                                        <img t-attf-src="data:image/png;base64, {{candidate.candidate_signature}}" alt="signature" class="rounded img-fluid" style="width: 150px;"/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-lg-9">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-8">
                                        <p class="mb-3">
                                            <strong>Whether Ship Visit was completed during training: <span class="text-danger">*</span></strong>
                                        </p>
                                    </div>
                                    <div class="col-3">
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" id="ship_visit_yes" name="ship_visit" t-att-checked="True"  />
                                            <label class="form-check-label" for="ship_visit_yes">
                                                Yes
                                            </label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" id="ship_visit_no" name="ship_visit" t-att-checked="False" />
                                            <label class="form-check-label" for="ship_visit_no">
                                                No
                                            </label>
                                        </div>
                                    </div>

                                    <t t-if="candidate.stcw_criteria == 'pending'">
                                        <div class="col-9">
                                            <p class="mb-0"><strong>Enter your STCW Certificates Details <span class="text-danger">(Mandatory for Application)</span>:  <span class="text-danger">*</span></strong></p>
                                        </div>
    
    
                                        <div class="col-6">
                                            <p class="text-muted">
                                                <a href="#" data-toggle="modal" data-target="#AddGPRepeaterStcw" class="btn btn-primary">Add STCW Certificate</a>
                                            </p>
                                            <ol class="list-group list-group-numbered">
                                                <h3>Minimum requirement is</h3>
                                                <li class="list-group-item">BST + STSDTD</li>
                                                    <span class="text-center">OR</span>
                                                <li class="list-group-item">PST + EFA + PSSR + FPFF + STSDTD</li>
                                            </ol>
                                        </div>
                                    </t>
    

                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="table-responsive border rounded border-top-0 mb-5">
                        <script>
                            function openSTCWDeleteModal(button) {

                                // Retrieve the data-id attribute value from the clicked button
                                var dataId = button.getAttribute('data-id');
                                var candidate_id = button.getAttribute('candidate-id');
                                // Update the content of the modal with the retrieved data
                                document.getElementById('gp_stcw_id').value = dataId;
                                document.getElementById('candidate_id').value = candidate_id;
                
                                }
                            
                                function openGPUpdateInstModal(a) {

                                // Retrieve the data-id attribute value from the clicked button
                                var dataId = a.getAttribute('stcw-id');
                                var candidate_id = a.getAttribute('candidate-id');
                                // Update the content of the modal with the retrieved data
                                document.getElementById('gp_stcw_line_id').value = dataId;
                                document.getElementById('candidate_id').value = candidate_id;
                
                                }
                        </script>
                        <table  class="table rounded mb-0 bg-white o_portal_my_doc_table">
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Course</th>
                                    <th>Institute Name</th>
                                    <th>Other Institute Name</th>
                                    <th>Candidate Certificate Number</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                </tr>
                            </thead>
                            <tbody id="gpstcwlist" >
                                <t t-foreach="candidate.stcw_certificate" t-as="stcw_certificate">
                                    <tr>
                                        <td>
                                            <!-- <button type="button" class="btn btn-danger" t-attf-data-id="{{stcw_certificate.id}}" t-attf-candidate-id="{{candidate.id}}" data-toggle="modal" onclick="openSTCWDeleteModal(this)" data-target="#DeleteSTCW">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"></path>
                                                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"></path>
                                                </svg>
                                            </button> -->
                                        </td>
                                        <td class="text-uppercase">
                                            <t t-out="stcw_certificate.course_name" />
                                        </td>
                                        <td>
                                            <t t-esc="stcw_certificate.institute_name.name" />
                                        </td>
                                        <td>
                                            <!-- Conditional display based on institute name and other_institute field -->
                                            <t t-if="stcw_certificate.institute_name.name == 'Others' or stcw_certificate.institute_name.id == 114">
                                                <t t-if="stcw_certificate.other_institute">
                                                    <t t-esc="stcw_certificate.other_institute" />
                                                </t>
                                                <t t-else="">
                                                    <a href="#" data-toggle="modal" t-attf-stcw-id="{{stcw_certificate.id}}" t-attf-candidate-id="{{candidate.id}}" data-target="#GPUpdateOtherInst" onclick="openGPUpdateInstModal(this)" class="btn btn-primary">Update Other Institute</a>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <!-- <t t-esc="stcw_certificate.institute_name.name" /> -->
                                            </t>
                                        </td>
  
                                        <td>
                                            <t t-out="stcw_certificate.candidate_cert_no" />
                                        </td>
                                        <td>
                                            <t t-out="stcw_certificate.course_start_date" />
                                        </td>
                                        <td>
                                            <t t-out="stcw_certificate.course_end_date" />
                                        </td>
                                    </tr>
                                    
                                </t>
                            </tbody>
                        </table>
                    </div>


                    <hr/>
                    <div class="row">
                        <div class="col-md-4">
                            <p class="mb-0"><strong>Mobile: <span class="text-danger">*</span></strong></p>
                            <t t-if="candidate.mobile">
                                <input type="number" class="form-control" id="mobile" name="mobile"
                                       t-att-value="candidate.mobile" disabled="true"/>
                            </t>
                            <t t-else="">
                                <input type="text" class="form-control validate_num" id="mobile" name="mobile" required="1" maxlength="10"/>
                                <span id="mobile-error" class="text-danger"></span>
                            </t> 
                        </div>
                        <div class="col-md-8">
                            <p class="mb-0"><strong>E-mail: <span class="text-danger">*</span></strong></p>
                            <t t-if="candidate.email">
                                <input type="email" class="form-control" id="email" name="email"
                                       t-att-value="candidate.email" disabled="true"/>
                            </t>
                            <t t-else="">
                                <input type="email" class="form-control" id="email" name="email" required="1"/>
                            </t>
                        </div>
                    </div>
       
                    <hr/>
                    <div class="form-group row">
                        <div class="col-lg-9">
                            <div class="row">
                                <div class="col-sm-3">
                                    <p class="mb-0"><strong>Address:</strong></p>
                                </div>
                                <div class="col-sm-9">
                                    <!-- Check if any of the address fields are filled -->
                                    <t t-if="candidate.street or candidate.street2 or candidate.city or candidate.state_id or candidate.zip">
                                        <!-- If any address field is filled, disable all inputs -->
                                        <div class="form-group">
                                            <label>Address Line 1: </label>
                                            <input type="text" class="form-control" id="address_line_1" name="street" t-att-value='candidate.street' disabled="true"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Address Line 2: </label>
                                            <input type="text" class="form-control" id="address_line_2" name="street2" t-att-value='candidate.street2' disabled="true"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Dist/City: </label>
                                            <input type="text" class="form-control" id="city" name="city" t-att-value='candidate.city' disabled="true"/>
                                        </div>
                                        <div class="form-group">
                                            <label>State: </label>
                                            <input type="text" class="form-control" id="state" name="state_id" t-att-value='candidate.state_id.name' disabled="true"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Pincode: </label>
                                            <input type="text" class="form-control" id="zip" name="zip" t-att-value='candidate.zip' disabled="true"/>
                                        </div>
                                    </t>
                                    <t t-else="">
                                        <!-- If no address field is filled, show editable inputs -->
                                        <div class="form-group">
                                            <label>Address Line 1: </label>
                                            <input type="text" class="form-control" id="address_line_1" name="street" required="1"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Address Line 2: </label>
                                            <input type="text" class="form-control" id="address_line_2" name="street2" required="1"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Dist/City: </label>
                                            <input type="text" class="form-control" id="city" name="city" required="1"/>
                                        </div>
                                        <div class="form-group">
                                            <label>State: </label>
                                            <input type="text" class="form-control" id="state" name="state_id" required="1"/>
                                        </div>
                                        <div class="form-group">
                                            <label>Pincode: </label>
                                            <input type="text" class="form-control" id="zip" name="zip" required="1"/>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>


                        
                    <hr/>
 
                    <div class="form-group row">
                        <div class="col-md-6">
                            <!-- <span t-esc="batch.to_date.strftime('%B')"/> -->
                            <label for="exam_centre">Exam Region Selected <strong class="text-danger">*</strong></label>
                            <t t-set="exam_month" t-value="batch.to_date.strftime('%B')"/>
                            <t t-if="exam_month not in ['March','September']">
                            <t t-set="fresher_region" t-value="env['exam.center'].sudo().search([])"/>

                                <select name="exam_centre" id="exam_centre" class="form-control" t-att-readonly="1" >

                                    <t t-foreach="fresher_region" t-as="region">
                                        <option t-att-value="region.id" t-att-selected="region.id == candidate.institute_id.exam_center.id"><t t-esc="region.name"/></option>
                                    </t>
                                </select>
                            </t>
                            <t t-else="">

                               <t t-set="region_repeater" t-value="env['exam.center'].sudo().search([('repeater_region','=',True)])"/>

                               <select name="exam_centre" id="exam_centre" class="form-control">

                                    <t t-foreach="region_repeater" t-as="region">
                                        <option t-att-value="region.id"><t t-esc="region.name"/></option> 
                                    </t>
                                </select>
                            </t>
                            
                        </div>
                        <div class="col-md-6">
                            <label for="training_institute">Exam Center</label>
                            <t t-if="exam_month not in ['March','September']">
                                <input type="text" t-att-disabled="1"  name="training_institute" id="training_institute" class="form-control" t-att-value="candidate.institute_id.name"/>
                            </t>
                            <t t-else="">
                                <input type="text" t-att-disabled="1"  name="training_institute" id="training_institute" class="form-control" placeholder="To be Announced"/>
                            </t>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="name">Attempt Number :</label>
                            <t t-set="attempt_no" t-value="(exam.attempt_number) + 1"/>
                            <input type="text" t-att-disabled="1" name="name" id="name" class="form-control" t-att-value="attempt_no"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-4">
                            <label for="exam_parts">Applied for Examination(s)  <strong class="text-danger">*</strong></label><br/>
                            <t t-if="exam.gsk_online_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="gsk_online" value="gsk_online_repeater" id="gsk_online" class="form-check-input exam-checkbox"/>
                                    <label for="gsk_online" class="form-check-label">GSK Online</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1"  name="gsk_online" value="gsk_online_repeater" id="gsk_online" class="form-check-input"/>
                                    <label for="gsk_online" class="form-check-label">GSK Online</label>
                                </div>                            
                            </t>

                            <t t-if="exam.mek_online_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="mek_online" value="mek_online_repeater" id="mek_online" class="form-check-input exam-checkbox"/>
                                    <label for="mek_online" class="form-check-label">MEK Online</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1" name="mek_online" value="mek_online_repeater" id="mek_online" class="form-check-input" />
                                    <label for="mek_online" class="form-check-label">MEK Online</label>
                                </div>                            
                            </t>

                            <t t-if="exam.gsk_oral_prac_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="gsk_practical_oral" value="gsk_po_repeater" id="gsk_practical_oral" class="form-check-input exam-checkbox"/>
                                    <label for="gsk_practical_oral" class="form-check-label">GSK Practical &amp; Oral</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1" name="gsk_practical_oral" value="gsk_po_repeater" id="gsk_practical_oral" class="form-check-input"/>
                                    <label for="gsk_practical_oral" class="form-check-label">GSK Practical &amp; Oral</label>
                                </div>
                            </t>

                            <t t-if="exam.mek_oral_prac_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="mek_practical_oral" value="mek_po_repeater" id="mek_practical_oral" class="form-check-input exam-checkbox" />
                                    <label for="mek_practical_oral" class="form-check-label">MEK Practical &amp; Oral</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1" name="mek_practical_oral" value="mek_po_repeater" id="mek_practical_oral" class="form-check-input"/>
                                    <label for="mek_practical_oral" class="form-check-label">MEK Practical &amp; Oral</label>
                                </div>
                            </t>

                        </div>
                        <div class="col-md-4">
                            <label for="fees">Fees to be Paid for Exam</label>
                            <t t-if="exam.gsk_online_status == 'failed'">
                                <div class="form-row">
                                   ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'gsk_online_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div>                           
                            </t>

                            <t t-if="exam.mek_online_status == 'failed'">
                                <div class="form-row">
                                    ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'mek_online_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div>                             
                            </t>

                            <t t-if="exam.gsk_oral_prac_status == 'failed'">
                                <div class="form-row">
                                    ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'gsk_po_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div> 
                            </t>

                            <t t-if="exam.mek_oral_prac_status == 'failed'">
                                <div class="form-row">
                                    ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'mek_po_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div>
                            </t>
                        </div>

                            
                        <div class="col-4">
                            <span><strong>Previous Examinamtion(s) Status</strong>(Red means Failed):</span>
                            <div class="form-check">
                                <t t-if="exam.gsk_online_status == 'failed'">
                                    <span id="gsk_online_status" class="badge badge-danger">GSK Online</span>
                                </t>
                                <t t-else="">
                                    <span id="gsk_online_status" class="badge badge-success">GSK Online</span>
                                </t>
                            </div>
                            <div class="form-check">
                                <t t-if="exam.mek_online_status == 'failed'">
                                    <span id="mek_online_status" class="badge badge-danger">MEK Online</span>
                                </t>
                                <t t-else="">
                                    <span id="mek_online_status" class="badge badge-success">MEK Online</span>
                                </t>
                            </div>
                            <div class="form-check">
                                <t t-if="exam.gsk_oral_prac_status == 'failed'">
                                    <span id="gsk_oral_prac_status" class="badge badge-danger">GSK Practical &amp; Oral</span>
                                </t>
                                <t t-else="">
                                    <span id="gsk_oral_prac_status" class="badge badge-success">GSK Practical &amp; Oral</span>
                                </t>
                            </div>
                            <div class="form-check">
                                <t t-if="exam.mek_oral_prac_status == 'failed'">
                                    <span id="mek_oral_prac_status" class="badge badge-danger">MEK Practical &amp; Oral</span>
                                </t>
                                <t t-else="">
                                    <span id="mek_oral_prac_status" class="badge badge-success">MEK Practical &amp; Oral</span>
                                </t>
                            </div>

                        </div>
    

                    </div>
                    <div class="form-group row">
                        <p id="selected-subjects">You have selected these subjects:</p>
                    </div>
                    <div class="form-group row">
                        <p>Total amount to be paid for booking of exams</p>
                    </div>
                    <div class="form-group row">
                        <span class="total_span"></span>
                    </div>
                    <hr/>
                    <div class="form-group row">
                        <div class="col-md-12">
                            <strong class="text-danger">The candidate shall pay the fees through QR Code Only. Other Modes of Payment are not acceptable.</strong>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-4">
                            <label for="gp_qr">Payment QR code</label><br/>
                            <img t-attf-src="/bes/static/src/img/GP_Repeater.jpg" alt="avatar" class="img-fluid" style="width: 125px;" />
                        </div>
                    </div>
                    <hr/>
                    <div class="form-group row">
                        <p>Make Payment and enter payment details</p>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-3">
                            <label for="upi_utr_no">UPI TRANSACTION ID/ UTR No. <strong class="text-danger">*</strong></label>
                            <input type="text" name="upi_utr_no" id="upi_utr_no" required="True" class="form-control"/>
                        </div>
                        <div class="col-md-3">
                            <label for="amount">Amount <strong class="text-danger">*</strong></label>
                            <input type="number" name="amount" id="amount" required="True" class="form-control" oninput="this.value = this.value.replace(/\./g, '');" />
                        </div>
                        <div class="col-md-3">
                            <label for="payment_date">Date <strong class="text-danger">*</strong></label>
                            <input type="date" name="payment_date" id="payment_date" required="True" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="transaction_slip">Upload Receipt/Bill (max file size - 1 MB): <strong class="text-danger">*</strong></label><br/>
                            <input type="file" id="transaction_slip" accept=".xlsx, .csv, .pdf , .jpeg , .png" name="transaction_slip" t-att-multiple="1" required="True"/><br/><br/>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">Submit</button><strong class="text-danger pl-5">Kindly fill in all the details before submission</strong>
                </form>

                <div id="alert_id" style="padding:20px" >
                    
                </div>
                

                <div class="modal fade" id="DeleteSTCW" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my/gprepeatercandidate/stcw/delete" enctype="multipart/form-data">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Delete STCW</h5>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete ?
                                    <input type="hidden" id="gp_stcw_id" name="gp_stcw_id"/>
                                    <input type="hidden" name="batch_id" id="batch_id" t-attf-value="{{batch.id}}" />
                                    <input type="hidden" id="candidate_id" name="candidate_id" t-attf-value="{{candidate.id}}"/>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="modal fade" id="AddGPRepeaterStcw" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my" >
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <input type="hidden" id="batch_id" name="batch_id" t-attf-value="{{batch.id}}" />
                            <t t-set="institutes" t-value="env['bes.institute'].sudo().search([])"/>
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add STCW Certificate</h5>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_name">Course</label>
                                                <select class="form-control" id="course_name" name="course_name" required="1">
                                                    <option value="pst">PST</option>
                                                    <option value="efa">EFA</option>
                                                    <option value="fpff">FPFF</option>
                                                    <option value="pssr">PSSR</option>
                                                    <option value="stsdsd">STSDSD</option>
                                                    <option value="bst">BST</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="institute_name">Institute Name</label>
                                                <select class="form-control" id="institute_name" name="institute_name" required="1" onchange="toggleInstituteInput()">
                                                    <t t-foreach="institutes" t-as="institute">
                                                        <option t-attf-value="{{institute.id}}">
                                                            <t t-out="institute.name"/>
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6" id="other_institute_name_container" style="display: none;">
                                            <div class="form-group">
                                                <label for="other_institute_name">Other Institute Name</label>
                                                <input type="text" class="form-control" id="other_institute_name" name="other_institute_name" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="candidate_cert_no">Candidate Certificate Number</label>
                                                <input type="text" class="form-control" id="candidate_cert_no" name="candidate_cert_no" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_start_date">Course Start Date</label>
                                                <input type="date" class="form-control" id="course_start_date" name="course_start_date" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_end_date">Course End Date</label>
                                                <input type="date" class="form-control" id="course_end_date" name="course_end_date" required="1"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-primary add_stcw_gp">Add</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="modal fade" id="GPUpdateOtherInst" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my/gp/update-inst" >
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <input type="hidden" id="batch_id" name="batch_id" t-attf-value="{{batch.id}}" />
                            <input type="hidden" id="gp_stcw_line_id" name="gp_stcw_line_id"/>
                            <input type="hidden" id="candidate_id" name="candidate_id" t-attf-value="{{candidate.id}}"/>
                            <t t-set="institutes" t-value="env['bes.institute'].sudo().search([])"/>
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Update Other Institute</h5>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label for="other_institute_name">Other Institute Name</label>
                                                <input type="text" class="form-control" id="other_institute_name" name="other_institute_name" required="1"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Add</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
            </div>
        </t>
    </template>

    <template id="ccmc_exam_application_form_template" name="Exam Application Form">
        <t t-call="website.layout">
            <script>
                document.addEventListener('DOMContentLoaded', function(event) {

                const checkboxes = document.querySelectorAll('.form-check-input');
                var totalAmountElement = document.querySelector('.total_span');

                checkboxes.forEach(function(checkbox) {
                    checkbox.addEventListener('change', updateTotalAmount);
                });
                


                function updateTotalAmount() {

                    let total = 0;
                    var anyChecked = false; 

                    checkboxes.forEach(function(checkbox) {
                        if (checkbox.checked) {
                            anyChecked = true; 
                            var postData = {
                                product_code: checkbox.value 
                            };

                            <!-- total += parseFloat(checkbox.value); -->
                            $.ajax({
                                        type: "POST",
                                        url: '/my/getproductprice',
                                        data: JSON.stringify(postData),
                                        contentType: 'application/json',
                                        success: function (response) {

                                            console.log("POST request successful:", JSON.parse(response.result));
                                            var amount = JSON.parse(response.result).amount

                                            <!-- debugger -->
                                            total += parseFloat(amount);
                                            totalAmountElement.textContent = 'Total Amount: ₹' + total;


                                            // if response["status"]
                                            // Handle success response
                                        },
                                            error: function (xhr, status, error) {
                                                console.error("POST request failed:", error);

                                                // Handle error
                                            }
                                        });
                        }

                        if (!anyChecked) {
                                total = 0;
                                totalAmountElement.textContent = 'Total Amount: ₹' + total;
                            }

                        
                    }
                    

                    
                    
                    
                    
                    
                    );

                    <!-- debugger -->


                }
            });
            function toggleInstituteInput() {
                var instituteSelect = document.getElementById("institute_name");
                var otherInstituteContainer = document.getElementById("other_institute_name_container");
        
                if (instituteSelect.value == "114") { // The ID for "Others"
                    otherInstituteContainer.style.display = "block";
                } else {
                    otherInstituteContainer.style.display = "none";
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                // Initialize variables for input elements
                var mobileInput = document.getElementById('mobile');
                var emailInput = document.getElementById('email');
                var errorParagraph = document.getElementById('mobile-error');
                var checkboxes = document.querySelectorAll('.exam-checkbox');
                var selectedSubjectsElement = document.getElementById('selected-subjects');
            
                // Disable mobile and email inputs if they already have values
                if (mobileInput.value) {
                    mobileInput.disabled = true;
                }
                if (emailInput.value) {
                    emailInput.disabled = true;
                }
            
                // Get today's date in YYYY-MM-DD format
                const today = new Date().toISOString().split('T')[0];
                
                // Set the max attribute of date inputs to today's date
                document.getElementById('payment_date').setAttribute('max', today);
                document.getElementById('course_start_date').setAttribute('max', today);
                document.getElementById('course_end_date').setAttribute('max', today);
            
                // Function to update the list of selected subjects
                function updateSelectedSubjects() {
                    var selectedSubjects = [];
                    checkboxes.forEach(function(checkbox) {
                        if (checkbox.checked) {
                            selectedSubjects.push(checkbox.nextElementSibling.textContent.trim());
                        }
                    });
            
                    // Display the selected subjects or a message if none are selected
                    if (selectedSubjects.length &gt; 0) {
                        selectedSubjectsElement.innerHTML = 'You have selected these subjects: <strong class='text-danger'>' + selectedSubjects.join(', ') + '</strong>';
                    } else {
                        selectedSubjectsElement.textContent = 'You have not selected any subjects.';
                    }
                }
            
                // Attach change event listeners to checkboxes
                checkboxes.forEach(function(checkbox) {
                    checkbox.addEventListener('change', updateSelectedSubjects);
                });
            
                // Initialize the selected subjects message on page load
                updateSelectedSubjects();
            
                // Function to validate mobile number length
                function validateMobileLength(input) {
                    var value = input.value.replace(/\D/g, ''); // Remove non-digit characters
            
                    // Trim value to 10 digits if necessary
                    if (value.length &gt; 10) {
                        input.value = value.slice(0, 10);
                    }
            
                    // Display an error message if the input length is less than 10 digits
                    if (value.length &lt; 10 &amp;&amp; value.length &gt; 0) {
                        errorParagraph.textContent = "Mobile number must be exactly 10 digits.";
                        input.setCustomValidity("Mobile number must be exactly 10 digits.");
                    } else if (value.length === 10) {
                        errorParagraph.textContent = ""; // Clear error message
                        input.setCustomValidity(""); // Clear custom validity
                    } else {
                        errorParagraph.textContent = ""; // Clear error message if input is empty
                        input.setCustomValidity(""); // Clear custom validity
                    }
                }
            
                // Attach input event listener to mobile input for validation
                if (mobileInput) {
                    mobileInput.addEventListener('input', function() {
                        validateMobileLength(mobileInput);
                    });
                }
            });
            
            
            </script>
            <div class="container mt16">
                <span style="color: red; font-weight: bold;font-size: 22px;">Click <a href="https://bestrust.in//document/download/3/4bc677d6-b8ed-45a9-928f-2afda007c659/4" target="_blank">here</a> to read instructions to fill the form</span>
                <h2>Application Form CCMC Rating (Repeater) Examination</h2>
                <p class="mb-0" style="font-size:20px;"><strong>Application For: <t t-out="batch.batch_name"/></strong></p>
                <p class="mb-0" style="font-size:20px;"><strong class="text-danger">Last date of submission for <t t-out="batch.to_date.strftime('%B %Y')"/> Examination: <t t-out="batch.form_deadline.strftime('%d-%b-%y')"/></strong></p>
                <p>All Fields are mandatory</p>
                <form id="ccmc_repeater_submission_form" name="ccmc_repeater_submit"  action="/my/ccmcapplication/view" enctype="multipart/form-data" method="post">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <input type="hidden" name="batch_id" id="batch_id" t-attf-value="{{batch.id}}" />
                    <input type="hidden" name="stcw_table_data" id="stcw_table_data"  />
                    <input type="hidden" name="certificate_criteria" id="certificate_criteria"  t-att-value="candidate.stcw_criteria"/>

                    <div class="form-group row">
                        <div class="col-lg-9">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Full Name:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.name"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Indos No:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.indos_no"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Code No:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.candidate_code"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong><label for="gender">Gender: <strong class="text-danger">*</strong></label></strong></p>
                                    </div>
                                    <div class="col-sm-3">
                                        <select class="form-control" id="gender" name="gender" required="1">
                                            <option value="male">Male</option>
                                            <option value="female">Female</option>
                                        </select>
                                    </div>
                                </div>
                                <hr/>
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Pre-Sea Training Institute:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <p class="text-muted mb-0">
                                            <t t-out="candidate.institute_id.name"/>
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                            </div>
                        </div>
                        
                        <div class="col-3 text-center">
                            <div class="row justify-content-center mb-2">
                                <div class="col-12">
                                    <t t-if="candidate.candidate_image">
                                        <img t-attf-src="data:image/png;base64, {{candidate.candidate_image}}" alt="avatar" class="rounded img-fluid" style="width: 150px;"/>
                                    </t>
                                    <t t-else="">
                                        <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" alt="avatar" class="rounded-circle img-fluid" style="width: 150px;"/>
                                    </t>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-12">
                                    <t t-if="candidate.candidate_signature">
                                        <img t-attf-src="data:image/png;base64, {{candidate.candidate_signature}}" alt="signature" class="rounded img-fluid" style="width: 150px;"/>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-lg-9">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-8">
                                        <p class="mb-3">
                                            <strong>Whether Ship Visit was completed during training: <span class="text-danger">*</span></strong>
                                        </p>
                                    </div>
                                    <div class="col-3">
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" id="ship_visit_yes" name="ship_visit" value="true" required="True" t-att-checked="True"/>
                                            <label class="form-check-label" for="ship_visit_yes">
                                                Yes
                                            </label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" id="ship_visit_no" name="ship_visit" value="false" required="True" t-att-checked="False"/>
                                            <label class="form-check-label" for="ship_visit_no">
                                                No
                                            </label>
                                        </div>
                                    </div>
                                    <t t-if="candidate.stcw_criteria == 'pending'">
                                        <div class="col-9">
                                            <p class="mb-0"><strong>Enter your STCW Certificates Details <span class="text-danger">(Mandatory for Application)</span>:  <span class="text-danger">*</span></strong></p>
                                        </div>
                                        <div class="col-6">
                                            <p class="text-muted">
                                                <a href="#" data-toggle="modal" data-target="#AddCCMCRepeaterStcw" class="btn btn-primary">Add STCW Certificate</a>
                                            </p>
                                            <ol class="list-group list-group-numbered">
                                                <h3>Minimum requirement is</h3>
                                                <li class="list-group-item">BST + STSDTD</li>
                                                    <span class="text-center">OR</span>
                                                <li class="list-group-item">PST + EFA + PSSR + FPFF + STSDTD</li>
                                            </ol>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive border rounded border-top-0 mb-5">
                        <script>
                            function openCCMCSTCWDeleteModal(button) {
                                <!-- debugger -->
                                // Retrieve the data-id attribute value from the clicked button
                                var dataId = button.getAttribute('data-id');
                                var candidate_id = button.getAttribute('candidate-id');
                                // Update the content of the modal with the retrieved data
                                document.getElementById('ccmc_stcw_id').value = dataId;
                                document.getElementById('candidate_id').value = candidate_id;
                
                                }
                                
                            function openCCMCUpdateInstModal(a) {
                                // Retrieve the data-id attribute value from the clicked button
                                var dataId = a.getAttribute('stcw-id');
                                var candidate_id = a.getAttribute('candidate-id');
                                // Update the content of the modal with the retrieved data
                                document.getElementById('ccmc_stcw_line_id').value = dataId;
                                document.getElementById('candidate_id').value = candidate_id;
                
                                }

                        </script>
                        <table class="table rounded mb-0 bg-white o_portal_my_doc_table">
                            <thead>
                                <tr>
                                    <th>Action</th>
                                    <th>Course</th>
                                    <th>Institute Name</th>
                                    <th>Other Institute Name</th>
                                    <th>Candidate Certificate Number</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                </tr>
                            </thead>
                            <tbody id="ccmcstcwlist">
                                <t t-foreach="candidate.stcw_certificate" t-as="stcw_certificate">
                                    <tr>
                                        <td>
                                            <!-- <button type="button" class="btn btn-danger" t-attf-data-id="{{stcw_certificate.id}}" t-attf-candidate-id="{{candidate.id}}" data-toggle="modal" onclick="openCCMCSTCWDeleteModal(this)" data-target="#CCMCDeleteSTCW">
                                                                
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                                                    <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"></path>
                                                    <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"></path>
                                                </svg>
                                            </button> -->
                                        </td>
                                        <td class="text-uppercase">
                                            <t t-out="stcw_certificate.course_name" />
                                        </td>
                                        <td>
                                            <t t-out="stcw_certificate.institute_name.name" />
                                        </td>
                                        <td>
                                            <!-- Conditional display based on institute name and other_institute field -->
                                            <t t-if="stcw_certificate.institute_name.name == 'Others' or stcw_certificate.institute_name.id == 114">
                                                <t t-if="stcw_certificate.other_institute">
                                                    <t t-esc="stcw_certificate.other_institute" />
                                                </t>
                                                <t t-else="">
                                                    <a href="#" data-toggle="modal" t-attf-stcw-id="{{stcw_certificate.id}}" t-attf-candidate-id="{{candidate.id}}" data-target="#CCMCUpdateOtherInst" onclick="openCCMCUpdateInstModal(this)" class="btn btn-primary">Update Institute Name</a>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <!-- <t t-esc="stcw_certificate.institute_name.name" /> -->
                                            </t>
                                        </td> 
                                        <td>
                                            <t t-out="stcw_certificate.candidate_cert_no" />
                                        </td>
                                        <td>
                                            <t t-out="stcw_certificate.course_start_date" />
                                        </td>
                                        <td>
                                            <t t-out="stcw_certificate.course_end_date" />
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>


                    <hr/>
                    <div class="row">
                        <div class="col-md-4">
                            <p class="mb-0"><strong>Mobile: <span class="text-danger">*</span></strong></p>
                            <t t-if="candidate.mobile">
                                <input type="number" class="form-control" id="mobile" name="mobile"
                                       t-att-value="candidate.mobile" disabled="true"/>
                            </t>
                            <t t-else="">
                                <input type="text" class="form-control validate_num" id="mobile" name="mobile" required="1" maxlength="10"/>
                                <span id="mobile-error" class="text-danger"></span>
                            </t>                            
                            
                        </div>
                        <div class="col-md-8">
                            <p class="mb-0"><strong>E-mail: <span class="text-danger">*</span></strong></p>
                            <t t-if="candidate.email">
                                <input type="email" class="form-control" id="email" name="email"
                                       t-att-value="candidate.email" disabled="true"/>
                            </t>
                            <t t-else="">
                                <input type="email" class="form-control" id="email" name="email"
                                       t-att-value="candidate.email"/>
                            </t>
                        </div>
                    </div>
                        <hr/>
                        <div class="form-group row">
                            <div class="col-lg-9">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <p class="mb-0"><strong>Address:</strong></p>
                                    </div>
                                    <div class="col-sm-9">
                                        <!-- Check if any of the address fields are filled -->
                                        <t t-if="candidate.street or candidate.street2 or candidate.city or candidate.state_id or candidate.zip">
                                            <!-- If any address field is filled, disable all inputs -->
                                            <div class="form-group">
                                                <label>Address Line 1: </label>
                                                <input type="text" class="form-control" id="address_line_1" name="street" t-att-value='candidate.street' disabled="true"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Address Line 2: </label>
                                                <input type="text" class="form-control" id="address_line_2" name="street2" t-att-value='candidate.street2' disabled="true"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Dist/City: </label>
                                                <input type="text" class="form-control" id="city" name="city" t-att-value='candidate.city' disabled="true"/>
                                            </div>
                                            <div class="form-group">
                                                <label>State: </label>
                                                <input type="text" class="form-control" id="state" name="state_id" t-att-value='candidate.state_id.name' disabled="true"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Pincode: </label>
                                                <input type="text" class="form-control" id="zip" name="zip" t-att-value='candidate.zip' disabled="true"/>
                                            </div>
                                        </t>
                                        <t t-else="">
                                            <!-- If no address field is filled, show editable inputs -->
                                            <div class="form-group">
                                                <label>Address Line 1: </label>
                                                <input type="text" class="form-control" id="address_line_1" name="street"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Address Line 2: </label>
                                                <input type="text" class="form-control" id="address_line_2" name="street2"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Dist/City: </label>
                                                <input type="text" class="form-control" id="city" name="city"/>
                                            </div>
                                            <div class="form-group">
                                                <label>State: </label>
                                                <input type="text" class="form-control" id="state" name="state_id"/>
                                            </div>
                                            <div class="form-group">
                                                <label>Pincode: </label>
                                                <input type="text" class="form-control" id="zip" name="zip"/>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>

                    



                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="exam_centre">Exam Region Selected</label>
                            <t t-set="exam_month" t-value="batch.to_date.strftime('%B')"/>
                            <t t-if="exam_month not in ['March','September']">
                                <t t-set="fresher_region" t-value="env['exam.center'].sudo().search([])"/>

                                <select name="exam_centre" id="exam_centre" class="form-control" t-att-readonly="1">

                                    <t t-foreach="fresher_region" t-as="region">
                                        <option t-att-value="region.id" t-att-selected="region.id == candidate.institute_id.exam_center.id"><t t-esc="region.name"/></option>
                                    </t>
                                </select>
                            </t>
                            <t t-else="">

                                <t t-set="region_repeater" t-value="env['exam.center'].sudo().search([('repeater_region','=',True)])"/>

                               <select name="exam_centre" id="exam_centre" class="form-control">

                                    <t t-foreach="region_repeater" t-as="region">
                                        <option t-att-value="region.id"><t t-esc="region.name"/></option>
                                    </t>
                                </select>
                            </t>
                        </div>

                        <div class="col-md-6">
                            <label for="training_institute">Exam Center</label>
                            <t t-if="exam_month not in ['March','September']">
                                <input type="text" t-att-disabled="1"  name="training_institute" id="training_institute" class="form-control" t-att-value="candidate.institute_id.name"/>
                            </t>
                            <t t-else="">
                                <input type="text" t-att-disabled="1"  name="training_institute" id="training_institute" class="form-control" placeholder="To be Announced"/>
                            </t>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="name">Attempt Number :</label>
                            <t t-set="attempt_no" t-value="(exam.attempt_number) + 1"/>
                            <input type="text" t-att-disabled="1" name="name" id="name" class="form-control" t-att-value="attempt_no"/>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-4">
                            <label for="exam_parts">Applied for Examination(s) <strong class="text-danger">*</strong></label><br/>
                            <t t-if="exam.cookery_bakery_prac_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="cookery_practical" value="ccmc_practical_repeater" id="cookery_practical" class="form-check-input exam-checkbox"/>
                                    <label for="cookery_practical" class="form-check-label">Cookery And Bakery</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1"  name="cookery_practical" value="ccmc_practical_repeater" id="cookery_practical" class="form-check-input"/>
                                    <label for="cookery_practical" class="form-check-label">Cookery And Bakery</label>
                                </div>                            
                            </t>

                            <t t-if="exam.ccmc_oral_prac_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="cookery_oral" value="ccmc_oral_repeater" id="cookery_oral" class="form-check-input exam-checkbox"/>
                                    <label for="cookery_oral" class="form-check-label">Cookery Oral</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1" name="Cookery Oral" value="ccmc_oral_repeater" id="cookery_oral" class="form-check-input"/>
                                    <label for="cookery_oral" class="form-check-label">Cookery Oral</label>
                                </div>                            
                            </t>

                            <t t-if="exam.ccmc_online_status == 'failed'">
                                <div class="form-check">
                                    <input type="checkbox" name="cookery_gsk_online" value="ccmc_online_repeater" id="cookery_gsk_online" class="form-check-input exam-checkbox"/>
                                    <label for="cookery_gsk_online" class="form-check-label">Cookery/GSK Online</label>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-check">
                                    <input type="checkbox" t-att-disabled="1" name="cookery_gsk_online" value="ccmc_online_repeater" id="cookery_gsk_online" class="form-check-input"/>
                                    <label for="cookery_gsk_online" class="form-check-label">Cookery/GSK Online</label>
                                </div>
                            </t>
                        </div>

                        <div class="col-md-4">
                            <label for="fees">Fees to be Paid for Exam</label>
                            <t t-if="exam.cookery_bakery_prac_status == 'failed'">
                                <div class="form-row">
                                   ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'ccmc_practical_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div>                           
                            </t>

                            <t t-if="exam.ccmc_oral_prac_status == 'failed'">
                                <div class="form-row">
                                    ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'ccmc_oral_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div>                             
                            </t>

                            <t t-if="exam.ccmc_online_status == 'failed'">
                                <div class="form-row">
                                    ₹<span t-esc="env['product.template'].sudo().search([('default_code', '=', 'ccmc_online_repeater' )]).list_price"/>
                                </div>
                            </t>
                            <t t-else="">
                                <div class="form-row">
                                    <span>---</span>
                                </div> 
                            </t>
                        </div>

                        <div class="col-md-4">
                            <span><strong>Previous Examinamtion(s) Status</strong>(Red means Failed):</span>
                            <div class="form-check">
                                <t t-if="exam.cookery_bakery_prac_status == 'failed'">
                                    <span id="cookery_bakery_prac_status" class="badge badge-danger">Cookery And Bakery</span>
                                </t>
                                <t t-else="">
                                    <span id="cookery_bakery_prac_status" class="badge badge-success">Cookery And Bakery</span>
                                </t>
                            </div>
                            <div class="form-check">
                                <t t-if="exam.ccmc_oral_prac_status == 'failed'">
                                    <span id="ccmc_oral_prac_status" class="badge badge-danger">Cookery Oral</span>
                                </t>
                                <t t-else="">
                                    <span id="ccmc_oral_prac_status" class="badge badge-success">Cookery Oral</span>
                                </t>
                            </div>
                            <div class="form-check">
                                <t t-if="exam.ccmc_online_status == 'failed'">
                                    <span id="ccmc_online_status" class="badge badge-danger">Cookery/GSK Online</span>
                                </t>
                                <t t-else="">
                                    <span id="ccmc_online_status" class="badge badge-success">Cookery/GSK Online</span>
                                </t>
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <p id="selected-subjects">You have selected these subjects:</p>
                    </div>
                    <div class="form-group row">
                        <p>Total amount to be paid for booking of exams</p>
                    </div>
                     <div class="form-group row">
                        <span class="total_span"></span>
                    </div>
                    <hr/>
                    <div class="form-group row">
                        <div class="col-md-12">
                            <strong class="text-danger">The candidate shall pay the fees through QR Code Only. Other Modes of Payment are not acceptable.</strong>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-4">
                            <label for="gp_qr">Payment QR code</label><br/>
                            <img t-attf-src="/bes/static/src/img/CCMC_Repeater.jpg" alt="avatar" class="img-fluid" style="width: 125px;" />
                        </div>
                    </div>

                    <div class="form-group row">
                        <p>Make Payment and enter payment details</p>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-3">
                            <label for="upi_utr_no">UPI TRANSACTION ID/ UTR No. <strong class="text-danger">*</strong></label>
                            <input type="text" name="upi_utr_no" id="upi_utr_no" required="True" class="form-control" />
                        </div>
                        <div class="col-md-3">
                            <label for="amount">Amount <strong class="text-danger">*</strong></label>
                            <input type="number" name="amount" id="amount" required="True" class="form-control" oninput="this.value = this.value.replace(/\./g, '');" />
                        </div>
                        <div class="col-md-3">
                            <label for="payment_date">Date <strong class="text-danger">*</strong></label>
                            <input type="date" name="payment_date" id="payment_date" required="True" class="form-control" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-md-6">
                            <label for="transaction_slip">Attach Receipt/Bill (max file size - 1 MB): <strong class="text-danger">*</strong></label><br/>
                            <input type="file" id="attachments" accept=".xlsx, .csv, .pdf , .jpeg , .png" name="transaction_slip" required="True"/><br/><br/>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">Submit</button><strong class="text-warning pl-5">Kindly fill in all the details before submission</strong>
                </form>
                <div id="alert_id" style="padding:20px" >
                    
                </div>

                <div class="modal fade" id="CCMCDeleteSTCW" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my/ccmcrepeatercandidate/stcw/delete" enctype="multipart/form-data">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Delete STCW</h5>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete ?
                                    <input type="hidden" id="ccmc_stcw_id" name="ccmc_stcw_id"/>
                                    <input type="hidden" name="batch_id" id="batch_id" t-attf-value="{{batch.id}}" />
                                    <input type="hidden" id="candidate_id" name="candidate_id" t-attf-value="{{candidate.id}}"/>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                
                <div class="modal fade" id="AddCCMCRepeaterStcw" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my/ccmcrepeatercandidate/addstcw" enctype="multipart/form-data">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <input type="hidden" id="batch_id" name="batch_id" t-attf-value="{{batch.id}}" />
                            <t t-set="institutes" t-value="env['bes.institute'].sudo().search([])"/>
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Add STCW Certificate</h5>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_name">Course</label>
                                                <select class="form-control" id="course_name" name="course_name" required="1">
                                                    <option value="pst">PST</option>
                                                    <option value="efa">EFA</option>
                                                    <option value="fpff">FPFF</option>
                                                    <option value="pssr">PSSR</option>
                                                    <option value="stsdsd">STSDSD</option>
                                                    <option value="bst">BST</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="institute_name">Institute Name</label>
                                                <select class="form-control" id="institute_name" name="institute_name" required="1" onchange="toggleInstituteInput()">
                                                    <t t-foreach="institutes" t-as="institute">
                                                        <option t-attf-value="{{institute.id}}">
                                                            <t t-out="institute.name"/>
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6" id="other_institute_name_container" style="display: none;">
                                            <div class="form-group">
                                                <label for="other_institute_name">Other Institute Name</label>
                                                <input type="text" class="form-control" id="other_institute_name" name="other_institute_name" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="candidate_cert_no">Candidate Certificate Number</label>
                                                <input type="text" class="form-control" id="candidate_cert_no" name="candidate_cert_no" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_start_date">Course Start Date</label>
                                                <input type="date" class="form-control" id="course_start_date" name="course_start_date" required="1"/>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="course_end_date">Course End Date</label>
                                                <input type="date" class="form-control" id="course_end_date" name="course_end_date" required="1"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary add_stcw_ccmc">Add</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                        <div id="alert_id" style="padding:20px" >
                    
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="CCMCUpdateOtherInst" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form method="post" action="/my/ccmc/update-inst" >
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                            <input type="hidden" id="batch_id" name="batch_id" t-attf-value="{{batch.id}}" />
                            <input type="hidden" id="ccmc_stcw_line_id" name="ccmc_stcw_line_id"/>
                            <input type="hidden" id="candidate_id" name="candidate_id" t-attf-value="{{candidate.id}}"/>
                            <t t-set="institutes" t-value="env['bes.institute'].sudo().search([])"/>
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Update Other Institute</h5>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label for="other_institute_name">Other Institute Name</label>
                                                <input type="text" class="form-control" id="other_institute_name" name="other_institute_name" required="1"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Add</button>
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </t>
    </template>
                



    <template id="candidate_not_found" name="Candidate Not Found">
        <t t-call="website.layout">
            <div class="container mt16">
                <h1>Candidate Not Found</h1>
                <p>Sorry, we could not find a candidate with the provided candidate code. Please check the code and try again.</p>
            </div>
        </t>
    </template>

    <template id="no_previous_exam_found" name="No Previous Exam Found">
        <t t-call="website.layout">
            <div class="container mt16">
                <h1>No Previous Exam Found</h1>
                <p>No previous exam records found. This candidate must be registered through batches.</p>
            </div>
        </t>
    </template>

    <template id="application_status" name="Exam In Process">
        <t t-call="website.layout">
            <div class="container mt16">
                <h1><t t-out="course"/> Repeater Examination Application Status</h1>

                <t t-if="invoice_exist and new_exam.state == '1-in_process' and not new_exam.hold_admit_card">
                    <div class="d-flex justify-content-between">
                        <p class="text-nowrap" style="font-size:20px;">Your Application No. <t t-out="invoice_exist.name"/> , for <t t-out="batch.to_date.strftime('%B %Y')"/> Repeater Examination:</p>
                        <strong class="text-success pl-2" style="font-size:20px;">Admit Card Generated,Please download. 
                        <t t-if="course == 'GP'">
                            <a t-attf-href="/my/gpexam/list/download_admit_card/{{new_exam.id}}" class="fa">Download Admit Card</a>
                        </t>
                        <t t-elif="course == 'CCMC'">
                            <a t-attf-href="/my/ccmcexam/list/download_admit_card/{{new_exam.id}}" class="fa">Download Admit Card</a>
                        </t>
                        </strong>
                    </div>
                </t>
                <t t-elif="invoice_exist.state == 'posted'">
                    <div class="d-flex justify-content-between">
                        <p class="text-nowrap" style="font-size:20px;">Your Application no. <t t-out="invoice_exist.name"/> , for <t t-out="batch.to_date.strftime('%B %Y')"/> Repeater Examination:</p>
                        <strong class="text-warning pl-2" style="font-size:20px;">Application in Process.</strong>
                    </div>
                </t>
                <t t-elif="invoice_exist and invoice_exist.state == 'draft'">
                    <div class="d-flex justify-content-between">
                        <p class="text-nowrap" style="font-size:20px;">Your Application no. <t t-out="invoice_exist.name"/> , for <t t-out="batch.to_date.strftime('%B %Y')"/> Repeater Examination:</p>
                        <strong class="text-danger pl-2" style="font-size:20px;">Your Payment Details are incorrect please contact BES (022-49606713).</strong>
                    </div>
                </t>
                
                <t t-elif="exam.state == '3-certified'">
                    <div class="d-flex justify-content-between">
                        <strong class="text-success pl-2" style="font-size:20px;">You are already passed. 
                            <!-- <t t-if="course == 'GP'">
                                <a t-attf-href="/my/gpexam/list/download_certificate/{{exam.id}}" class="fa">Download Certificate</a>
                            </t>
                            <t t-elif="course == 'CCMC'">
                                <a t-attf-href="/my/ccmcexam/list/download_certificate/{{exam.id}}" class="fa">Download Certificate</a>
                            </t> -->
                        </strong>
                    </div>
                </t>
            </div>                        
        </t>
    </template>

       <template id="gprepeaterregister" name="Register Repeater">
        <style>
            body {
                margin: 0;
                font-family: Arial, sans-serif;
            }
            .header {
                display: flex;
                align-items: center;
                padding: 10px;
                background-color: #f8f8f8;
                border-bottom: 1px solid #ddd;
            }
            .header img {
                height: 50px;
                margin-right: 20px;
            }
            .header h1 {
                margin: 0;
                font-size: 24px;
            }
            ody {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 20px;
                background-color: #f4f4f4;
            }
            .form-container {
                max-width: 800px;
                margin: 0 auto;
                background-color: #fff;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }
            .form-container h2 {
                text-align: center;
                margin-bottom: 20px;
            }
            .form-group {
                margin-bottom: 15px;
            }
            .form-group label {
                display: block;
                margin-bottom: 5px;
            }
            .form-group input[type="text"],
            .form-group input[type="file"] {
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            .form-group input[type="submit"] {
                width: 100%;
                padding: 10px;
                background-color: #007BFF;
                color: #fff;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 16px;
            }
            .form-group input[type="submit"]:hover {
                background-color: #0056b3;
            }
            .image-preview-container {
                position: absolute;
                top: 20px;
                right: 20px;
                text-align: center;
            }
            .image-preview-container img {
                max-width: 100px;
                margin-bottom: 10px;
                display: none;
            }

            .card-img-container {
                        text-align: right;
                        margin-bottom: 10px;
                        }

            .card-img {
                        width: 150px; /* Adjust the width as needed */
                        height: 150px; /* Adjust the height as needed */
                        object-fit: cover;
                        border-radius: 10px; /* Make it square by setting border-radius to half of the width/height */
                        }
        </style>
        <script>
        function displayImage(input) {
                    const cardImg = document.querySelector('.card-img-photo');
                    const file = input.files[0];

                    if (file) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        cardImg.src = e.target.result;
                    };

                    reader.readAsDataURL(file);
                    }
                }

                function displaySignImage(input) {
                    const cardImg = document.querySelector('.sign-img');
                    const file = input.files[0];

                    if (file) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        cardImg.src = e.target.result;
                    };

                    reader.readAsDataURL(file);
                    }
                }
        </script>


       <!-- <t t-call="portal.portal_layout"> -->
            <header class="header">
                <img src="/bes/static/src/img/logo_bes.jpg" alt="Logo"/>
                <h1>Board Of Examinations For Seafarers Trust</h1>
            </header>


            <div class="form-container">
        <h2>Candidate Form</h2>
            
        <div class="card-img-container">
                <!-- <img id="candidate_image_preview" src="#" alt="Candidate Image Preview" /> -->
                <img src="https://placehold.co/250x75" class="card-img-top card-img sign-img" style="width: 250px; height:75px" alt="Signature" />
                <img id="candidate_image_preview" src="https://via.placeholder.com/150" class="card-img-top card-img card-img-photo" style="width: 150px;" alt="Candidate Photo" />
        </div>
        <form action="/register/repeater/candidate" method="post" enctype="multipart/form-data">
        	<input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />

            <div class="form-group">
                <label for="course">Courses</label>
                <select class="form-control" id="course" name="course">
                        <option value="gp">GP</option>
                        <option value="ccmc">CCMC</option>
                </select>
            </div>
            <div class="form-group">
                <label for="candidate_image">Upload Candidate Image</label>
                <input type="file" id="candidate_image" onchange="displayImage(this)" name="candidate_image" accept="image/*" />
            </div>
            <div class="form-group">
                <label for="signature_image">Upload Signature Image</label>
                <input type="file" id="signature_image" onchange="displaySignImage(this)"  name="signature_image" accept="image/*" />
            </div>
            <div class="form-group">
                <label for="indos">Indos No.</label>
                <input type="text" id="indos" name="indos" />
            </div>
            <div class="form-group">
                <label for="name">Name of Candidate as in Indos</label>
                <input type="text" id="name" name="name" />
            </div>
            <div class="form-group">
                <label for="candidate_code">Candidate Code</label>
                <input type="text" id="candidate_code" name="candidate_code"  />
            </div>
            <div class="form-group">
                <t t-set="institutes" t-value="env['bes.institute'].sudo().search([])"/>
                <label for="institute_id">Parent Institute</label>
                <select class="form-control" id="institute_id" name="institute_id">
                    <t t-foreach="institutes" t-as="institute">
                        <option t-attf-value="{{institute.id}}" >
                            <t t-esc="institute.name"/>
                        </option>
                    </t>
                </select>
            </div>
            <div class="form-group">
                <label for="gender">Gender</label>
                <select class="form-control" id="gender" name="gender">
                        <option t-attf-value="male" >
                            Male
                        </option>
                        <option t-attf-value="female" >
                            Female
                        </option>
                </select>
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="text" id="email" name="email"  />
            </div>          
            <div class="form-group">
                <label for="phone">Phone</label>
                <input type="text" id="phone" name="phone"  />
            </div>          
            
            <div class="form-group">
                <input type="submit" value="Submit"/>
            </div>
        </form>
    </div>
            <!-- </t> -->
    </template>

</odoo>
